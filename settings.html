<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASH TRACK - Settings</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="shared.js"></script>
    <style>
        /* --- SAME BASE STYLES AS index.html --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3a0ca3;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #fca311;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --card-shadow: 0 10px 20px rgba(0,0,0,0.05),0 6px 6px rgba(0,0,0,0.1);
            --header-shadow: 0 4px 18px rgba(0,0,0,0.15);
            --background: linear-gradient(135deg, #f5f7fb 0%, #e5e9f2 100%);
            --card-bg: white;
            --text-color: #212529;
        }
        body {
            background: var(--background);
            color: var(--text-color);
            min-height: 100vh;
            opacity: 0;
            animation: fadeIn 0.8s ease-out forwards;
        }
        @keyframes fadeIn { from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:translateY(0);} }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

        header {
            background: linear-gradient(120deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: var(--header-shadow);
            position: relative; overflow: hidden;
            animation: slideDown 0.7s ease-out;
        }
        @keyframes slideDown { from { transform: translateY(-100%); opacity:0; } to { transform: translateY(0); opacity:1; } }
        header::before {
            content: '';
            position: absolute; top: -50%; right: -50%; width: 100%; height: 200%;
            background: linear-gradient(transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg); animation: shimmer 8s infinite linear;
        }
        @keyframes shimmer { 0% { transform: rotate(45deg) translateX(-100%);} 100% {transform: rotate(45deg) translateX(200%);} }

        .header-content { display: flex; justify-content: space-between; align-items: center; padding: 0 20px; position: relative; z-index: 1; }
        .logo { font-size:28px; font-weight:700; display:flex; align-items:center; animation:bounceIn 1s ease-out; }
        @keyframes bounceIn { 0%{transform:scale(0.8);opacity:0;}50%{transform:scale(1.05);}100%{transform:scale(1);opacity:1;} }
        .logo i { margin-right:10px; background: rgba(255,255,255,0.2); padding:10px; border-radius:12px; }

        nav ul { display:flex; list-style:none; }
        nav ul li { margin-left:20px; }
        nav ul li a {
            color:white; text-decoration:none; font-weight:500; padding:8px 16px; border-radius:10px;
            transition: all 0.3s; display:flex; align-items:center; position:relative; overflow:hidden;
        }
        nav ul li a::before {
            content:''; position:absolute; top:0; left:-100%; width:100%; height:100%;
            background: linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);
            transition: 0.5s;
        }
        nav ul li a:hover::before { left:100%; }
        nav ul li a i { margin-right:8px; }
        nav ul li a:hover, nav ul li a.active { background: rgba(255,255,255,0.2); transform: translateY(-2px); }

        .card { background: var(--card-bg); border-radius:16px; padding:25px; box-shadow:var(--card-shadow); transition: transform 0.3s, box-shadow 0.3s; border:1px solid rgba(0,0,0,0.05); animation: fadeInUp 0.6s ease-out; margin-bottom: 25px; }
        @keyframes fadeInUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }
        .card h2 { color: var(--primary); margin-bottom:20px; display:flex; align-items:center; padding-bottom:15px; border-bottom:2px solid var(--light-gray); }
        .card h2 i { margin-right:12px; background: var(--primary-light); color:white; padding:8px; border-radius:10px; }

        .form-group { margin-bottom:20px; position:relative; }
        .form-group label { display:block; margin-bottom:8px; font-weight:500; color: var(--text-color); }
        .form-group input, .form-group select, .form-group textarea { width:100%; padding:14px; border:1px solid var(--light-gray); border-radius:10px; font-size:16px; transition:border-color 0.3s, box-shadow 0.3s; background: var(--card-bg); color: var(--text-color); }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline:none; border-color: var(--primary); box-shadow:0 0 0 3px rgba(67,97,238,0.2); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%{box-shadow:0 0 0 0 rgba(67,97,238,0.4);}70%{box-shadow:0 0 0 10px rgba(67,97,238,0);}100%{box-shadow:0 0 0 0 rgba(67,97,238,0);} }

        button { background: linear-gradient(to right, var(--primary), var(--primary-light)); color:white; border:none; padding:14px 24px; border-radius:10px; cursor:pointer; font-size:16px; font-weight:500; transition: all 0.3s; display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; }
        button::before { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); transition:0.5s; }
        button:hover::before { left:100%; }
        button i { margin-right:8px; }
        button:hover { transform:translateY(-2px); box-shadow:0 7px 14px rgba(67,97,238,0.3); }
        
        .btn-danger { background: linear-gradient(to right, var(--danger), #ff4da6); }
        .btn-warning { background: linear-gradient(to right, var(--warning), #ffb74d); }
        .btn-success { background: linear-gradient(to right, var(--success), #6ae1ff); }
        
        .toggle-switch { position: relative; display: inline-block; width: 60px; height: 30px; margin-left: 15px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .toggle-slider:before { position: absolute; content: ""; height: 22px; width: 22px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: var(--primary); }
        input:checked + .toggle-slider:before { transform: translateX(30px); }
        
        .toggle-container { display: flex; align-items: center; margin-bottom: 15px; }
        .toggle-label { flex: 1; }
        
        .settings-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(500px, 1fr)); gap: 25px; }
        
        .notification-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--light-gray); }
        .notification-item:last-child { border-bottom: none; }
        
        .toast { position: fixed; bottom: 20px; right: 20px; background: var(--dark); color: white; padding: 15px 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); display: flex; align-items: center; z-index: 1000; opacity: 0; transform: translateY(100px); transition: all 0.3s; }
        .toast.show { opacity: 1; transform: translateY(0); }
        .toast i { margin-right: 10px; font-size: 20px; }
        .toast.success { background: var(--success); }
        .toast.error { background: var(--danger); }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal-content { background: var(--card-bg); padding: 30px; border-radius: 16px; box-shadow: var(--card-shadow); max-width: 500px; width: 100%; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-close { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--gray); }
        
        .password-strength { height: 5px; margin-top: 8px; border-radius: 5px; background: #eee; }
        .password-strength-bar { height: 100%; border-radius: 5px; width: 0%; transition: width 0.3s, background 0.3s; }
        
        /* Dark theme overrides */
        body.dark-theme {
            --background: linear-gradient(135deg, #121212 0%, #2d2d2d 100%);
            --card-bg: #2d2d2d;
            --text-color: #f8f9fa;
            --light-gray: #495057;
        }
        
        @media (max-width:768px) {
            .header-content { flex-direction:column; text-align:center; }
            nav ul { margin-top:15px; justify-content:center; flex-wrap:wrap; }
            nav ul li { margin:5px; }
            .settings-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo"><i class="fas fa-wallet"></i> CASH TRACK</div>
                <nav>
                    <ul>
                        <li><a href="index.html"><i class="fas fa-home"></i> Dashboard</a></li>
                        <li><a href="reports.html"><i class="fas fa-chart-pie"></i> Reports</a></li>
                        <li><a href="settings.html" class="active"><i class="fas fa-cog"></i> Settings</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="settings-grid">
            <!-- Profile Settings -->
            <div class="card">
                <h2><i class="fas fa-user-cog"></i> Profile Settings</h2>
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="language">Language</label>
                    <select id="language">
                        <option value="en">English</option>
                        <option value="es">Español</option>
                        <option value="fr">Français</option>
                        <option value="de">Deutsch</option>
                    </select>
                </div>
            </div>

            <!-- Currency & Preferences -->
            <div class="card">
                <h2><i class="fas fa-dollar-sign"></i> Currency & Preferences</h2>
                <div class="form-group">
                    <label for="currency">Currency</label>
                    <select id="currency">
                        <option value="USD">USD - $</option>
                        <option value="EUR">EUR - €</option>
                        <option value="INR">INR - ₹</option>
                        <option value="GBP">GBP - £</option>
                        <option value="JPY">JPY - ¥</option>
                        <option value="CAD">CAD - C$</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date-format">Date Format</label>
                    <select id="date-format">
                        <option value="mm/dd/yyyy">MM/DD/YYYY</option>
                        <option value="dd/mm/yyyy">DD/MM/YYYY</option>
                        <option value="yyyy-mm-dd">YYYY-MM-DD</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="theme">Theme</label>
                    <select id="theme">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="auto">Auto (System)</option>
                    </select>
                </div>
            </div>

            <!-- Notifications -->
            <div class="card">
                <h2><i class="fas fa-bell"></i> Notifications</h2>
                <div class="notification-item">
                    <div class="toggle-label">Budget Alerts</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notify-budget">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="notification-item">
                    <div class="toggle-label">Bill Reminders</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notify-bills">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="notification-item">
                    <div class="toggle-label">Weekly Reports</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notify-reports">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="notification-item">
                    <div class="toggle-label">Security Alerts</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notify-security">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>

            <!-- Data Management -->
            <div class="card">
                <h2><i class="fas fa-database"></i> Data Management</h2>
                <div class="form-group">
                    <label for="auto-backup">Auto Backup Frequency</label>
                    <select id="auto-backup">
                        <option value="never">Never</option>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </div>
                <div class="form-group">
                    <button class="btn-success" onclick="exportData()"><i class="fas fa-file-export"></i> Export Data</button>
                </div>
                <div class="form-group">
                    <label for="import-file">Import Data</label>
                    <input type="file" id="import-file" accept=".json">
                    <button class="btn-warning" onclick="importData()"><i class="fas fa-file-import"></i> Import Data</button>
                </div>
                <div class="form-group">
                    <button class="btn-danger" onclick="showClearDataModal()"><i class="fas fa-trash-alt"></i> Clear All Data</button>
                </div>
            </div>

            <!-- Change Password -->
            <div class="card">
                <h2><i class="fas fa-lock"></i> Change Password</h2>
                <div class="form-group">
                    <label for="current-password">Current Password</label>
                    <input type="password" id="current-password" placeholder="Enter current password">
                </div>
                <div class="form-group">
                    <label for="new-password">New Password</label>
                    <input type="password" id="new-password" placeholder="Enter new password" oninput="checkPasswordStrength()">
                    <div class="password-strength">
                        <div class="password-strength-bar" id="password-strength-bar"></div>
                    </div>
                    <small id="password-strength-text"></small>
                </div>
                <div class="form-group">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" placeholder="Confirm new password">
                </div>
                <button onclick="changePassword()"><i class="fas fa-key"></i> Change Password</button>
            </div>

            <!-- Account Management -->
            <div class="card">
                <h2><i class="fas fa-user-shield"></i> Account Management</h2>
                <div class="form-group">
                    <button class="btn-warning" onclick="showDeleteAccountModal()"><i class="fas fa-user-times"></i> Delete Account</button>
                </div>
                <div class="form-group">
                    <button class="btn-danger" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Clear Data Modal -->
    <div class="modal" id="clear-data-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Clear All Data</h2>
                <button class="modal-close" onclick="closeModal('clear-data-modal')">&times;</button>
            </div>
            <p>Are you sure you want to clear all your data? This action cannot be undone.</p>
            <div class="form-group">
                <label for="confirm-clear">Type "DELETE" to confirm</label>
                <input type="text" id="confirm-clear" placeholder="Type DELETE here">
            </div>
            <button class="btn-danger" onclick="clearAllData()"><i class="fas fa-trash-alt"></i> Clear All Data</button>
        </div>
    </div>

    <!-- Delete Account Modal -->
    <div class="modal" id="delete-account-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Delete Account</h2>
                <button class="modal-close" onclick="closeModal('delete-account-modal')">&times;</button>
            </div>
            <p>Are you sure you want to delete your account? All your data will be permanently lost.</p>
            <div class="form-group">
                <label for="confirm-delete">Type "DELETE MY ACCOUNT" to confirm</label>
                <input type="text" id="confirm-delete" placeholder="Type DELETE MY ACCOUNT here">
            </div>
            <button class="btn-danger" onclick="deleteAccount()"><i class="fas fa-user-times"></i> Delete Account Permanently</button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">Settings saved successfully!</span>
    </div>

    <script>
        // CURRENCY AND THEME FUNCTIONS (to be used across all pages)
        
        // Get currency symbol based on currency code
        function getCurrencySymbol(currencyCode) {
            const symbols = {
                'USD': '$',
                'EUR': '€',
                'INR': '₹',
                'GBP': '£',
                'JPY': '¥',
                'CAD': 'C$'
            };
            return symbols[currencyCode] || '$';
        }
        
        // Format amount with currency symbol
        function formatCurrency(amount, currencyCode = null) {
            const code = currencyCode || localStorage.getItem('currency') || 'USD';
            const symbol = getCurrencySymbol(code);
            
            // Format number with thousands separators
            const formattedAmount = parseFloat(amount).toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            
            // Position symbol based on currency
            if (code === 'USD' || code === 'CAD' || code === 'GBP') {
                return `${symbol}${formattedAmount}`;
            } else if (code === 'EUR') {
                return `${formattedAmount} ${symbol}`;
            } else {
                return `${symbol} ${formattedAmount}`;
            }
        }
        
        // Apply theme to the page
        function applyTheme(theme) {
            // Remove any existing theme classes
            document.body.classList.remove('dark-theme');
            
            // Determine which theme to apply
            let effectiveTheme = theme;
            if (theme === 'auto') {
                effectiveTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            }
            
            // Apply the theme
            if (effectiveTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            
            // Save theme preference
            localStorage.setItem('theme', theme);
            
            // Update theme selector if it exists
            const themeSelector = document.getElementById('theme');
            if (themeSelector) {
                themeSelector.value = theme;
            }
        }
        
        // Initialize theme on page load
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            applyTheme(savedTheme);
        }
        
        // Initialize currency on page load
        function initCurrency() {
            const savedCurrency = localStorage.getItem('currency') || 'USD';
            const currencySelector = document.getElementById('currency');
            if (currencySelector) {
                currencySelector.value = savedCurrency;
            }
            return savedCurrency;
        }
        
        // MAIN SETTINGS FUNCTIONS

// Load settings from localStorage
document.addEventListener('DOMContentLoaded', () => {
    // Initialize theme and currency
    initApp();
    
    // Load basic settings
    document.getElementById('username').value = localStorage.getItem('username') || '';
    document.getElementById('email').value = localStorage.getItem('email') || '';
    document.getElementById('language').value = localStorage.getItem('language') || 'en';
    document.getElementById('date-format').value = localStorage.getItem('dateFormat') || 'mm/dd/yyyy';
    document.getElementById('auto-backup').value = localStorage.getItem('autoBackup') || 'never';
    
    // Load notification settings
    document.getElementById('notify-budget').checked = localStorage.getItem('notifyBudget') !== 'false';
    document.getElementById('notify-bills').checked = localStorage.getItem('notifyBills') !== 'false';
    document.getElementById('notify-reports').checked = localStorage.getItem('notifyReports') !== 'false';
    document.getElementById('notify-security').checked = localStorage.getItem('notifySecurity') !== 'false';
});

// Save all settings
function saveSettings() {
    // Basic settings
    const username = document.getElementById('username').value;
    const email = document.getElementById('email').value;
    const currency = document.getElementById('currency').value;
    const theme = document.getElementById('theme').value;
    const language = document.getElementById('language').value;
    const dateFormat = document.getElementById('date-format').value;
    const autoBackup = document.getElementById('auto-backup').value;
    
    localStorage.setItem('username', username);
    localStorage.setItem('email', email);
    localStorage.setItem('currency', currency);
    localStorage.setItem('language', language);
    localStorage.setItem('dateFormat', dateFormat);
    localStorage.setItem('autoBackup', autoBackup);
    
    // Notification settings
    localStorage.setItem('notifyBudget', document.getElementById('notify-budget').checked);
    localStorage.setItem('notifyBills', document.getElementById('notify-bills').checked);
    localStorage.setItem('notifyReports', document.getElementById('notify-reports').checked);
    localStorage.setItem('notifySecurity', document.getElementById('notify-security').checked);
    
    // Apply theme immediately
    applyTheme(theme);
    
    // Trigger storage event to update other tabs
    window.dispatchEvent(new Event('storage'));
    
    showToast('Settings saved successfully!', 'success');
}

// ... rest of the existing settings functions remain unchanged 

        // Change password functionality
        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                showToast('Please fill in all password fields', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showToast('New passwords do not match', 'error');
                return;
            }
            
            // In a real app, you would verify the current password with the server
            // For this demo, we'll just simulate success
            showToast('Password changed successfully!', 'success');
            
            // Clear password fields
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        }

        // Check password strength
        function checkPasswordStrength() {
            const password = document.getElementById('new-password').value;
            const strengthBar = document.getElementById('password-strength-bar');
            const strengthText = document.getElementById('password-strength-text');
            
            // Calculate strength (simple version)
            let strength = 0;
            let text = '';
            let color = '';
            
            if (password.length > 0) {
                if (password.length < 6) {
                    strength = 20;
                    text = 'Very Weak';
                    color = '#ff4d4d';
                } else if (password.length < 8) {
                    strength = 40;
                    text = 'Weak';
                    color = '#ff8c66';
                } else if (password.length < 10) {
                    strength = 60;
                    text = 'Medium';
                    color = '#ffca80';
                } else if (password.length < 12) {
                    strength = 80;
                    text = 'Strong';
                    color = '#a0e65c';
                } else {
                    strength = 100;
                    text = 'Very Strong';
                    color = '#4cd964';
                }
                
                // Check for special characters and numbers
                if (password.match(/[0-9]/)) strength += 10;
                if (password.match(/[A-Z]/)) strength += 10;
                if (password.match(/[^a-zA-Z0-9]/)) strength += 10;
                
                // Cap at 100
                strength = Math.min(strength, 100);
            }
            
            strengthBar.style.width = strength + '%';
            strengthBar.style.background = color;
            strengthText.textContent = text;
            strengthText.style.color = color;
        }

        // Export data functionality
        function exportData() {
            // Gather all data from localStorage
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }
            
            // Create a blob and download link
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cash-track-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('Data exported successfully!', 'success');
        }

        // Import data functionality
        function importData() {
            const fileInput = document.getElementById('import-file');
            const file = fileInput.files[0];
            
            if (!file) {
                showToast('Please select a file to import', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Confirm before overwriting data
                    if (confirm('This will overwrite your current data. Are you sure?')) {
                        // Clear existing data
                        localStorage.clear();
                        
                        // Import new data
                        for (const key in data) {
                            localStorage.setItem(key, data[key]);
                        }
                        
                        // Reload settings
                        document.getElementById('username').value = localStorage.getItem('username') || '';
                        document.getElementById('email').value = localStorage.getItem('email') || '';
                        document.getElementById('currency').value = localStorage.getItem('currency') || 'USD';
                        document.getElementById('theme').value = localStorage.getItem('theme') || 'light';
                        document.getElementById('language').value = localStorage.getItem('language') || 'en';
                        document.getElementById('date-format').value = localStorage.getItem('dateFormat') || 'mm/dd/yyyy';
                        document.getElementById('auto-backup').value = localStorage.getItem('autoBackup') || 'never';
                        
                        // Apply theme
                        applyTheme(localStorage.getItem('theme') || 'light');
                        
                        showToast('Data imported successfully!', 'success');
                    }
                } catch (error) {
                    showToast('Invalid file format', 'error');
                    console.error(error);
                }
            };
            reader.readAsText(file);
        }

        // Show clear data modal
        function showClearDataModal() {
            document.getElementById('clear-data-modal').style.display = 'flex';
        }

        // Clear all data
        function clearAllData() {
            const confirmation = document.getElementById('confirm-clear').value;
            
            if (confirmation !== 'DELETE') {
                showToast('Please type "DELETE" to confirm', 'error');
                return;
            }
            
            localStorage.clear();
            showToast('All data has been cleared', 'success');
            closeModal('clear-data-modal');
            
            // Reset form values
            document.getElementById('username').value = '';
            document.getElementById('email').value = '';
            document.getElementById('currency').value = 'USD';
            document.getElementById('theme').value = 'light';
            document.getElementById('language').value = 'en';
            document.getElementById('date-format').value = 'mm/dd/yyyy';
            document.getElementById('auto-backup').value = 'never';
            document.getElementById('confirm-clear').value = '';
        }

        // Show delete account modal
        function showDeleteAccountModal() {
            document.getElementById('delete-account-modal').style.display = 'flex';
        }

        // Delete account
        function deleteAccount() {
            const confirmation = document.getElementById('confirm-delete').value;
            
            if (confirmation !== 'DELETE MY ACCOUNT') {
                showToast('Please type "DELETE MY ACCOUNT" to confirm', 'error');
                return;
            }
            
            // In a real app, this would make an API call to delete the account
            // For this demo, we'll just clear localStorage and redirect
            localStorage.clear();
            showToast('Account deleted successfully', 'success');
            
            setTimeout(() => {
                alert('Account deleted. Redirecting to home page.');
                window.location.href = 'index.html';
            }, 2000);
        }

        // Logout functionality
        function logout() {
            // In a real app, this would make an API call to invalidate the session
            // For this demo, we'll just redirect
            if (confirm('Are you sure you want to logout?')) {
                showToast('Logged out successfully', 'success');
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1500);
            }
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type} show`;
            
            // Change icon based on type
            const icon = toast.querySelector('i');
            if (type === 'success') {
                icon.className = 'fas fa-check-circle';
            } else {
                icon.className = 'fas fa-exclamation-circle';
            }
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.className = 'toast';
            }, 3000);
        }

        // Auto-save when any setting changes
        const inputs = document.querySelectorAll('input, select');
        inputs.forEach(input => {
            input.addEventListener('change', saveSettings);
        });
    </script>
</body>
</html>